"use strict";
Object.defineProperty(exports, "__esModule", { value: true });
exports.CurrentGamePerks = void 0;
const util_1 = require("../../util");
/**
 * A representation of the rune setup of a live game participant.
 */
class CurrentGamePerks {
    /**
     * Creates a new Current Game perks instance.
     * @param runeTrees - The collection of the runes in the game.
     * @param data - The raw current game participant perks data from the API.
     */
    constructor(runeTrees, data) {
        /**
         * The runes selected by the participant.
         */
        Object.defineProperty(this, "selected", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        /**
         * The stat runes selected by the participant.
         */
        Object.defineProperty(this, "stats", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        /**
         * The primary rune tree selected by the participant.
         */
        Object.defineProperty(this, "primaryTree", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        /**
         * The secondary rune tree selected by the participant.
         */
        Object.defineProperty(this, "secondaryTree", {
            enumerable: true,
            configurable: true,
            writable: true,
            value: void 0
        });
        this.primaryTree = runeTrees.find((r) => r.id === data.perkStyle);
        this.secondaryTree = runeTrees.find((r) => r.id === data.perkSubStyle);
        const stat = data.perkIds.filter((p) => Object.keys(util_1.rawStatPerks).includes(p.toString()));
        this.stats = stat.map((p) => util_1.rawStatPerks[p]);
        const selected = data.perkIds.filter((p) => !stat.includes(p));
        const runes = runeTrees.map((t) => t.slots.map((r) => [...r.values()])).flat(2);
        this.selected = selected.map((p) => runes.find((v) => v.id === p));
    }
}
exports.CurrentGamePerks = CurrentGamePerks;
//# sourceMappingURL=CurrentGamePerks.js.map